[
  {
    "objectID": "notes/notes_3.html",
    "href": "notes/notes_3.html",
    "title": "Modelling Environmental Extremes",
    "section": "",
    "text": "Overview\nWe might want to know more about the maxima and minima of the environmental system we are modelling. For example, we might want to know how strong to make buildings to deal with earthquakes, how high to build flood defences, or how to prepare for extreme low temperatures.\nWe are trying to model rare events — by their very definition we won’t have a lot of data on these. The bulk of the data in any statistical distribution will be in the centre. Standard density estimation techniques (eg the normal distribution) work well where the data have the greatest density, but that’s not what we need here. We need to use a statistical model which is good at estimating the tails of our distribution.\n\n\nExtreme Value Distributions\nThe first thing we have to consider is what actually represents an extreme observation. This will vary depending on the context of the dataset.\nA lot of investigation of environmental extremes will focus on time series data. Within time series data, we typically have natural groupings or blocks of observations (days, months, years etc) Therefore a common approach for modelling extremes focuses on the idea of block maxima — identifying the maximum (or minimum) value in each block. For example, if we have daily temperature data measured over 100 years, we could look at the highest temperature in each year.\nSuppose we have a series of random variables \\(X_1, \\ldots, X_n\\), each with cumulative distribution function \\(F\\), where \\(F(x) = \\text{P}(X \\leq x)\\). We can define the maximum of this set of random variables as \\(M_n = \\max{\\{ X_1, \\ldots, X_n\\}}\\). Then we can show that \\(\\text{P}(M_n \\leq x) = P(X_1 \\leq x, \\ldots X_x \\leq x) = \\{F(x)\\}^n = F^n(x)\\).\nThis suggests that to understand block maxima (the maximum value in blocks of observations), we might focus on estimating \\(F^n(x)\\). However, this approach faces two fundamental problems:\n\nThe Estimation Problem - The true cumulative distribution \\(F(x)\\) is unknown. While we could estimate it from data, small errors in estimating \\(F(x)\\) - especially in the tail where \\(F(x)\\) is close to 1 - are magnified exponentially when raised to the power \\(n\\). A tiny underestimation of the tail probability can lead to dramatically underestimating \\(F^n(x)\\).\nThe Degeneracy Problem - Note that as \\(n \\to \\infty\\) then the value of \\(F^n(x)\\) will be 0 or 1 depending on whether \\(F(x) &lt;1\\) or \\(F(x)=1\\). This means that the limit distribution of the maxima is a degenerate distribution. In simple terms, if you keep taking more and more samples, the maximum just keeps increasing until it effectively becomes a fixed extreme value, with no interesting variation left to model.\n\nInstead of trying to estimate \\(F\\) or \\(F^n\\) directly, Extreme Value Theory shifts focus to the limiting distribution of the normalized maximum. We introduce sequences \\(a_n &gt; 0\\) and \\(b_n\\) to stabilize the maximum as \\(n\\) grows. This is a distribution \\(G(x)\\) such that, for constants, \\(a_n &gt; 0\\) and \\(b_n\\),\n\\[\\text{P}\\left(\\frac{M_n - b_n}{a_n} \\leq x\\right) = F^n(a_n x + b_n) \\to G(x) \\text{ as } n \\to \\infty\\]\nThere are three main families of extreme value distribution which have our desired properties as limiting distributions of \\(F^n(x)\\).\n\nGumbel: \\(G(x) = \\exp \\left( -\\exp [\\frac{-(x-a)}{b} ]\\right)\\)\nFrechet: \\(G(x) = \\exp \\left( -[\\frac{(x-a)}{b} ]^{-\\alpha}\\right)\\) for \\(z&gt;b\\), 0 otherwise.\nWeibull: \\(G(x) = \\exp \\left( -[\\frac{-(x-a)}{b} ]^{\\alpha}\\right)\\) for \\(z&gt;b\\), 1 otherwise.\n\nHere, \\(a\\) is a location parameter, \\(b\\) is a scale parameter and \\(\\alpha\\) is a shape parameter.\nMore generally, we can model the maxima using the Generalised Extreme Value (GEV) distribution \\[G(x) = \\exp \\left( - \\left[ 1 + \\frac{\\xi (z - \\mu)}{\\sigma} \\right]^{-\\frac{1}{\\xi}} \\right)\\]\nHere, \\(\\mu\\) is the location parameter, \\(\\sigma\\) is the scale parameter and \\(\\xi\\) is the shape parameter. The Gumbel, Frechet and Weibull distributions are all special cases depending on the value of \\(\\xi\\).\n\n\n\n\n\n\nIf \\(\\xi &lt; 0\\) then we have the Weibull distribution.\nIf \\(\\xi &gt; 0\\) then we have the Frechet distribution.\nAs \\(\\xi \\to 0\\) then we have the Gumbel distribution.\n\n\n\n\n\n\n\n Task\n\n\n\nLet a random vector \\(\\mathbf{X} = X_1,\\ldots,X_n\\) such that \\(\\mathbf{X}\\overset{iid}{\\sim}\\mathrm{Uniform}(0,1)\\). Setting the normalizing constants \\(a_n = 1/n\\) and \\(b_n =1\\), show that the limiting distribution of the maxima \\(M_n =\\mathrm{max}(\\mathbf{X})\\) as \\(n\\to \\infty\\) is a GEV with \\(\\mu= -1\\) ,\\(\\sigma = 1\\) and \\(\\xi = -1\\)\n\n\nTake Hint\n\nRecall that the CDF of an U(0,1) is given by \\(F(x) = x ~(\\text{for } 0 \\leq x \\leq 1)\\), also note that:\n\\[\n\\lim_{n \\to \\infty}\\left( 1 + \\frac{1}{n} x\\right)^n  = \\exp{x}\n\\]\n\n\n\nSolution\n\n\\[\n\\begin{aligned}\n\\mathbb{Pr}\\left(\\dfrac{M_n -b_n}{a_n}\\leq x \\right) & = \\mathbb{Pr}(M_n \\leq b_n +a_n x)\\\\\n& = F\\left(b_n +a_n x\\right)^n\\\\\n&= F\\left(1 + \\frac{1}{n}x\\right)^n\\\\\n& = \\left(1 + \\frac{1}{n}x\\right)^n ~~~\\text{for } 0 \\leq 1 + x/n   \\leq 1 \\\\\n&\\rightarrow \\exp x~ \\text{as }  n \\to \\infty\n\\end{aligned}\n\\] Let \\(G(x) = \\exp \\left\\{- (1 + \\xi \\frac{x -\\mu}{\\sigma})^{-1/xi}\\right\\}\\), setting \\(\\mu= -1\\) ,\\(\\sigma = 1\\) and \\(\\xi = -1\\)\n\\[\nG(x) =  \\exp \\left\\{- (1 -x + 1 )\\right\\} = \\exp x\n\\]\n\n\n\nThe following app illustrates EVT how the block maxima of a random variable fits a GEV distribution as the sample size increases. The app will generate some samples (blocks) of size \\(n\\) drawn from a specified distribution (Uniform(0,1) or Exp(1)) and plot the distribution (histograms) of the maximum of each sample. Then, it compares the empirical histograms against the theoretical GEV (solid red line). For example, if \\(X\\sim\\text{Uniform(0,1)}\\) and we standardise the maxima using \\(b_n=1\\) and \\(a_n=1/n\\) the asymptotic distribution of the maxima is a GEV(\\(\\mu=-1,\\sigma=1,\\xi=-1\\)) (see the previous task). Likewise, if \\(X\\sim \\exp(1)\\) and we let \\(a_n=1\\) and \\(b_n= \\log n\\), the its maxima will converge to a GEV(\\(\\mu=0,\\sigma=1,\\xi=0\\)), i.e., a Gumbell distribution (see the proof in the tutorial material).\n\n\n\n\n\n\n Task\n\n\n\nPlay around with the app settings to see the impact that the number of samples and the size of blocks have on the approximation of the GEV for the different distributions.\n\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 500\n\nlibrary(shiny)\n\n\n\n# Function to generate block maxima\ngenerate_max &lt;- function(N, n, rdist, param, a, b, seed=pi){\n  set.seed(seed)\n  Mn &lt;- numeric(N)\n  for(i in 1:N){\n    sample &lt;- rdist(n, param[1], param[2])\n    Mn[i] &lt;- (max(sample) - b) / a\n  }\n  return(Mn)\n}\n\n# UI\niu &lt;- fluidPage(\n  titlePanel(\"Block Maxima Simulation\"),\n  sidebarLayout(\n    sidebarPanel(\n      selectInput(\"dist\", \"Choose Distribution:\", choices = c(\"Uniform(0,1)\" = \"uniform\", \"Exponential(1)\" = \"exponential\")),\n      sliderInput(\"n\", \"Observations per Block (n):\", min = 5, max = 100, value = 5, step = 5),\n      sliderInput(\"N\", \"Number of Blocks (N):\", min = 10000, max = 50000, value = 50000, step = 10000)\n    ),\n    mainPanel(\n      plotOutput(\"histogram\")\n    )\n  )\n)\n\n# Server\nserver &lt;- function(input, output) {\n  output$histogram &lt;- renderPlot({\n    if (input$dist == \"uniform\") {\n      a &lt;- 1 / input$n\n      b &lt;- 1\n      Mn &lt;- generate_max(input$N, input$n, runif, c(0,1), a, b)\n      true_gev &lt;- function(x) evd::dgev(x, loc = -1, scale = 1, shape = -1)\n    } else {\n      a &lt;- 1\n      b &lt;- log(input$n)\n      Mn &lt;- generate_max(input$N, input$n, rgamma, c(1,1), a, b)\n      true_gev &lt;- function(x) evd::dgev(x, loc = 0, scale = 1, shape = 0)\n    }\n    \n    hist(Mn, breaks = \"FD\", col = \"lightblue\", prob = TRUE, main = \"Histogram of Block Maxima\", xlab = \"Maxima\")\n    curve(true_gev, col = \"red\", lwd = 2, add = TRUE)\n  })\n}\n\n# Run App\nshinyApp(ui = iu, server = server)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Module 2",
    "section": "",
    "text": "#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 500\nlibrary(shiny)\n\n\n# Function to generate block maxima\ngenerate_max &lt;- function(N, n, rdist, param, a, b, seed=pi){\n  set.seed(seed)\n  Mn &lt;- numeric(N)\n  for(i in 1:N){\n    sample &lt;- rdist(n, param[1], param[2])\n    Mn[i] &lt;- (max(sample) - b) / a\n  }\n  return(Mn)\n}\n\n# UI\niu &lt;- fluidPage(\n  titlePanel(\"Block Maxima Simulation\"),\n  sidebarLayout(\n    sidebarPanel(\n      selectInput(\"dist\", \"Choose Distribution:\", choices = c(\"Uniform(0,1)\" = \"uniform\", \"Exponential(1)\" = \"exponential\")),\n      sliderInput(\"n\", \"Observations per Block (n):\", min = 5, max = 100, value = 5, step = 5),\n      sliderInput(\"N\", \"Number of Blocks (N):\", min = 10000, max = 50000, value = 50000, step = 10000)\n    ),\n    mainPanel(\n      plotOutput(\"histogram\")\n    )\n  )\n)\n\n# Server\nserver &lt;- function(input, output) {\n  output$histogram &lt;- renderPlot({\n    if (input$dist == \"uniform\") {\n      a &lt;- 1 / input$n\n      b &lt;- 1\n      Mn &lt;- generate_max(input$N, input$n, runif, c(0,1), a, b)\n      true_gev &lt;- function(x) evd::dgev(x, loc = -1, scale = 1, shape = -1)\n    } else {\n      a &lt;- 1\n      b &lt;- log(input$n)\n      Mn &lt;- generate_max(input$N, input$n, rgamma, c(1,1), a, b)\n      true_gev &lt;- function(x) evd::dgev(x, loc = 0, scale = 1, shape = 0)\n    }\n    \n    hist(Mn, breaks = \"FD\", col = \"lightblue\", prob = TRUE, main = \"Histogram of Block Maxima\", xlab = \"Maxima\")\n    curve(true_gev, col = \"red\", lwd = 2, add = TRUE)\n  })\n}\n\n# Run App\nshinyApp(ui = iu, server = server)\n\nThis module provides the foundational principles and practical skills for processing, evaluating, and interpreting environmental and ecological data. It begins by contextualizing the role of statistics in environmental science, using contemporary news and research to illustrate how quantitative evidence informs public discourse and policy. The core of the module focuses on characterizing and managing the inherent uncertainty, variability, and common issues found in environmental and ecological data — such as censored data, outliers, and missing values—found in empirical datasets. We will also revise some core statistical concepts and look further into how environmental data is sourced, from different sampling strategies to monitoring network design."
  },
  {
    "objectID": "index.html#lectures",
    "href": "index.html#lectures",
    "title": "Module 2",
    "section": "2.1 Lectures",
    "text": "2.1 Lectures\nThere will be two - 1 hr lectures per week\n\nTuesday 12 noon (Wolfson Medical School:253 Seminar 1-Yudo)\nWednesday 9am (Maths and Stats:116 Lecture Theatre).\n\n\n\n\n\n\n\nNote\n\n\n\nLectures will be recorded if the room’s technology allows them to be."
  },
  {
    "objectID": "index.html#tutorials",
    "href": "index.html#tutorials",
    "title": "Module 2",
    "section": "2.2 Tutorials",
    "text": "2.2 Tutorials\nIn addition, there will be four tutorials for this course. There are two tutorial groups - please check on MyCampus which one you are in.\n\nTutorial Group 1 - Monday 10amTutorial Group 2- Wednesday 12 noon\n\n\nTutorial groups:\n\nSTATS 4009 - TU01 (23738)\nSTATS 5031 - TU01 (24174)\n\nVenue:\nAdam Smith: 281\nTutorial dates:\n\n26-Jan-2026\n09-Feb-2026\n23-Feb-2026\n09-Mar-2026\n\n\n\nTutorial groups:\n\nSTATS 4009 - TU02 (23739)\nSTATS 5031 - TU02 (24175)\n\nVenue:\nJoseph Black Building:C407 Agricultm\nTutorial dates:\n\n28 -Jan-2026\n11-Feb-2026\n25-Feb-2026\n11-Mar-2026\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nYou are expected to have attempted the exercise sheets before the tutorial - they will be available in advance."
  },
  {
    "objectID": "index.html#labs",
    "href": "index.html#labs",
    "title": "Module 2",
    "section": "2.3 Labs",
    "text": "2.3 Labs\nThere will be three labs taking place in Boyd Orr Building:418 Lab from 15:00-17:00pm on the following dates (clicking on the date will direct you to the lab material):\n\nLab session 1 - Jan 30th\nFeb 27th\nMarch 13th"
  }
]